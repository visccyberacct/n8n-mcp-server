---
description: Configure n8n MCP server credentials (hostname and API key)
---

# n8n Setup Command

Interactive setup to configure the n8n MCP server plugin with your n8n instance credentials.

## What This Does

1. **Collects** your n8n instance URL and API key
2. **Creates/updates** the `.env` file in the plugin directory
3. **Validates** the configuration format
4. **Guides** you through next steps

## Setup Process

Follow these steps to configure the n8n MCP server:

### 1. Welcome Message

Display this message to the user:

```
üîß n8n MCP Server Setup
========================

This will configure the n8n MCP server plugin to connect to your n8n instance.

I need two pieces of information:

1. **n8n Instance URL** - The full URL where your n8n instance is hosted
   Example: https://n8n.homelab.com or https://n8n.example.com

2. **n8n API Key** - Your personal API key from n8n
   To get an API key:
   - Log into your n8n instance
   - Go to Settings > API
   - Click "Create API Key"
   - Copy the generated key (you won't be able to see it again)

Ready to begin? Please provide your n8n instance URL.
```

### 2. Collect n8n Instance URL

Use the AskUserQuestion tool to ask for the n8n instance URL:

```
Question: "What is your n8n instance URL?"
Header: "Instance URL"
Options:
  - label: "https://n8n.homelab.com"
    description: "Homelab instance (default)"
  - label: "https://app.n8n.cloud/..."
    description: "n8n Cloud instance"
  - label: "Custom URL"
    description: "Enter a different URL"
```

Store the user's response as `N8N_URL`.

If the URL doesn't start with `http://` or `https://`, prepend `https://` to it.

Remove any trailing slashes from the URL.

### 3. Collect n8n API Key

Use the AskUserQuestion tool to ask for the API key:

```
Question: "What is your n8n API Key? (You can find this in n8n Settings > API)"
Header: "API Key"
Options:
  - label: "I have my API key ready"
    description: "Paste your API key when prompted"
  - label: "I need to create one first"
    description: "Get instructions on how to create an API key"
```

If the user selects "I need to create one first", display:

```
üìù How to Create an n8n API Key:

1. Open your n8n instance in a browser
2. Click on your profile icon (top right)
3. Select "Settings"
4. Navigate to the "API" section
5. Click "Create API Key"
6. Give it a name (e.g., "Claude MCP")
7. Copy the generated key immediately (it won't be shown again)
8. Come back here and provide the key

Once you have your API key, please provide it below.
```

Then ask again for the API key as free text input.

Store the user's API key as `N8N_API_KEY`.

### 4. Validate Input

Validate that both values are provided:

```bash
# Check N8N_URL is not empty
if [ -z "$N8N_URL" ]; then
  echo "‚ùå Error: n8n instance URL cannot be empty"
  exit 1
fi

# Check N8N_API_KEY is not empty
if [ -z "$N8N_API_KEY" ]; then
  echo "‚ùå Error: n8n API key cannot be empty"
  exit 1
fi

echo "‚úì Configuration values validated"
```

### 5. Determine Plugin Directory

The plugin directory location depends on how the plugin was installed.

For installed plugins, use `${CLAUDE_PLUGIN_ROOT}` if available, otherwise use the project root.

**Note**: Since we're running as a command within the plugin, the `.env` file should be created in the plugin's root directory, not the user's working directory.

### 6. Create/Update .env File

Write the configuration to the `.env` file in the plugin directory:

```bash
# Create .env file with configuration
cat > .env << 'EOF'
# n8n MCP Server Configuration
# Auto-generated by /n8n-setup command

# Your n8n instance URL
N8N_BASE_URL=<N8N_URL>

# Your n8n API key (from Settings > API)
N8N_API_KEY=<N8N_API_KEY>
EOF

echo "‚úì Configuration saved to .env"
```

Replace `<N8N_URL>` and `<N8N_API_KEY>` with the actual values collected from the user.

### 7. Verify .env File Created

```bash
# Verify .env file was created
if [ -f ".env" ]; then
  echo "‚úì .env file created successfully"

  # Show sanitized confirmation (hide API key)
  echo ""
  echo "Configuration:"
  echo "  N8N_BASE_URL=<N8N_URL>"
  echo "  N8N_API_KEY=***${N8N_API_KEY: -4}"
else
  echo "‚ùå Error: Failed to create .env file"
  exit 1
fi
```

Replace `<N8N_URL>` with the actual URL, and use the last 4 characters of the API key for display.

### 8. Display Next Steps

Show the user what to do next:

```
‚úÖ n8n MCP Server Configuration Complete!
===========================================

Your n8n instance has been configured:
  üìç Instance: <N8N_URL>
  üîë API Key: Configured (ending in ...XXXX)

Next Steps:
-----------

1. **Restart Claude Code**
   The MCP server needs to be restarted to pick up the new configuration.

   Close and reopen Claude Code or restart the MCP server.

2. **Test the Connection**
   Try running:
   - "List my n8n workflows"
   - "Show me workflow executions"
   - "Get workflow details for [workflow-name]"

3. **Start Automating**
   You can now:
   - Create and manage workflows
   - Execute workflows
   - Monitor workflow runs
   - Update workflow configurations

Troubleshooting:
----------------

If you get authentication errors:
  ‚Ä¢ Verify your API key is still valid in n8n Settings > API
  ‚Ä¢ Check that your n8n instance URL is correct
  ‚Ä¢ Re-run /n8n-setup to update credentials

If you can't connect:
  ‚Ä¢ Ensure your n8n instance is running and accessible
  ‚Ä¢ Check network connectivity
  ‚Ä¢ Verify the URL includes the protocol (https://)

Need help? Run /n8n-setup again to reconfigure.
```

Replace `<N8N_URL>` and `XXXX` with the actual values.

### 9. Security Reminder

Display a security reminder:

```
üîí Security Note:
-----------------
Your API key is stored locally in the .env file and is never shared.
This file is excluded from git commits (.gitignore).

If your API key is compromised:
1. Log into n8n
2. Go to Settings > API
3. Delete the compromised key
4. Create a new API key
5. Re-run /n8n-setup with the new key
```

## Example Session

```
User: /n8n-setup
Assistant: üîß n8n MCP Server Setup
========================

This will configure the n8n MCP server plugin to connect to your n8n instance...

[Shows welcome message]

Claude: What is your n8n instance URL?

User: https://n8n.homelab.com

Claude: What is your n8n API Key?

User: n8n_api_1234567890abcdef...

Claude: [Creates .env file]

‚úÖ n8n MCP Server Configuration Complete!
===========================================

Your n8n instance has been configured:
  üìç Instance: https://n8n.homelab.com
  üîë API Key: Configured (ending in ...cdef)

[Shows next steps...]
```

## Important Notes

- The command is interactive and guides the user step-by-step  
- The `.env` file is created in the plugin root directory
- API keys are partially masked for security when displayed
- Users must restart Claude Code after configuration
- The command can be re-run to update credentials

## File Location

The `.env` file will be created at:
- **Installed plugin**: `${CLAUDE_PLUGIN_ROOT}/.env`
- **Development**: Project root `.env`

Make sure the `.env` file is in the same directory as the `n8n_mcp` module for proper loading.
